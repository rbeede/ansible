- name: Ensure Firefox default profile folder exists
  ansible.builtin.command:
    cmd: firefox --headless --marionette
    creates: "/home/rbeede/.mozilla/firefox/*.default-release"
  async: 20
  poll: 0

- name: Close Firefox Marionette
  ansible.builtin.command:
    cmd: echo '37:[0, 1234, "WebDriver:NewSession", {}]32:[0, 1235, "Marionette:Quit", {}]' | nc localhost 2828
    creates: "/home/rbeede/.mozilla/firefox/*.default-release"

- name: Firefox - Turn off remember password
  ansible.builtin.copy:
    dest: "/home/rbeede/.mozilla/firefox/*.default-release/user.js"
    content: |
      user_pref("signon.rememberSignons", false);
    mode: '0444'
